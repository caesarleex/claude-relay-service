import{aP as Ie,r as B,x as n,y as d,z as e,L as v,Q as X,ac as te,K as g,C as E,P as b,O as u,S as H,aq as h,_ as Q,q as xe,aX as Ee,c as pe,o as me,Z as Ve,u as k,al as W,aT as O,R as be,aV as ee,J as Pe,T as _e,Y as $e}from"./vue-vendor-R8HMg95E.js";import{c as D,_ as ye,s as i}from"./index-OJ2dWut5.js";import"./element-plus-BQHxDbdW.js";import"./vendor-Dr8jvgFu.js";const Fe=Ie("settings",()=>{const A=B({siteName:"Claude Relay Service",siteIcon:"",siteIconData:"",showAdminButton:!0,updatedAt:null}),m=B(!1),j=B(!1),o=async()=>{m.value=!0;try{const p=await D.get("/admin/oem-settings");return p&&p.success&&(A.value={...A.value,...p.data},l()),p}catch(p){throw console.error("Failed to load OEM settings:",p),p}finally{m.value=!1}},x=async p=>{j.value=!0;try{const f=await D.put("/admin/oem-settings",p);return f&&f.success&&(A.value={...A.value,...f.data},l()),f}catch(f){throw console.error("Failed to save OEM settings:",f),f}finally{j.value=!1}},K=async()=>{const p={siteName:"Claude Relay Service",siteIcon:"",siteIconData:"",showAdminButton:!0,updatedAt:null};return A.value={...p},await x(p)},l=()=>{if(A.value.siteName&&(document.title=`${A.value.siteName} - 管理后台`),A.value.siteIconData||A.value.siteIcon){const p=document.querySelector('link[rel="icon"]')||document.createElement("link");p.rel="icon",p.href=A.value.siteIconData||A.value.siteIcon,document.querySelector('link[rel="icon"]')||document.head.appendChild(p)}};return{oemSettings:A,loading:m,saving:j,loadOemSettings:o,saveOemSettings:x,resetOemSettings:K,applyOemSettings:l,formatDateTime:p=>p?new Date(p).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"",validateIconFile:p=>{const f=[];return p.size>350*1024&&f.push("图标文件大小不能超过 350KB"),["image/x-icon","image/png","image/jpeg","image/jpg","image/svg+xml"].includes(p.type)||f.push("不支持的文件类型，请选择 .ico, .png, .jpg 或 .svg 文件"),{isValid:f.length===0,errors:f}},fileToBase64:p=>new Promise((f,L)=>{const P=new FileReader;P.onload=q=>f(q.target.result),P.onerror=L,P.readAsDataURL(p)})}}),je={name:"PromptsView",props:{embedded:{type:Boolean,default:!1}},setup(){const A=B([{id:"codex",name:"Codex CLI",description:"OpenAI Responses 服务的默认提示词",icon:"fas fa-code"},{id:"claudeCode",name:"Claude Code",description:"Claude Code 服务的默认提示词",icon:"fas fa-robot"},{id:"droid",name:"Droid",description:"Droid (Factory.ai) 服务的默认提示词",icon:"fas fa-wrench"}]),m=[{id:"manual",name:"手动编辑",icon:"fas fa-edit"},{id:"upload",name:"文件上传",icon:"fas fa-upload"},{id:"url",name:"URL 导入",icon:"fas fa-link"}],j=B(!1),o=Q({codex:"",claudeCode:"",droid:""}),x=Q({}),K=B({}),l=Q({}),c=Q({}),U=Q({}),_=Q({codex:"manual",claudeCode:"manual",droid:"manual"}),p=Q({codex:"",claudeCode:"",droid:""}),f=Q({codex:null,claudeCode:null,droid:null}),L=async()=>{try{const a=await D.get("/admin/prompts/meta/config");if(a.success){const w={};a.data.forEach(M=>{w[M.id]=M}),K.value=w}else i("加载配置元数据失败","error")}catch(a){console.error("Failed to load configs:",a),i("加载配置元数据失败","error")}},P=async()=>{j.value=!0;try{await L();for(const a of A.value){const w=await D.get(`/admin/prompts/${a.id}`);w.success&&(o[a.id]=w.content||"",x[a.id]={lastModified:w.lastModified,enabled:w.enabled,length:w.length})}}catch(a){console.error("Failed to load prompts:",a),i("加载 Prompts 失败","error")}finally{j.value=!1}},q=async a=>{var w,M;l[a]=!0;try{const V=await D.put(`/admin/prompts/${a}`,{content:o[a]});V.success?(i("保存成功","success"),await P()):i(V.error||"保存失败","error")}catch(V){console.error(`Failed to save ${a} prompt:`,V),i(((M=(w=V.response)==null?void 0:w.data)==null?void 0:M.error)||"保存失败","error")}finally{l[a]=!1}},S=()=>{const a=document.querySelector('input[type="file"][accept=".txt"]');a&&(a.value="",a.click())},J=async(a,w)=>{var V,T;const M=w.target.files[0];if(M){if(!M.name.endsWith(".txt")){i("仅支持 .txt 文件","error");return}if(M.size>1024*1024){i("文件大小不能超过 1MB","error");return}c[a]=!0;try{const R=new FormData;R.append("file",M);const Y=await D.post(`/admin/prompts/${a}/upload`,R,{headers:{"Content-Type":"multipart/form-data"}});Y.success?(i("上传成功","success"),await P(),_[a]="manual"):i(Y.error||"上传失败","error")}catch(R){console.error(`Failed to upload ${a} prompt:`,R),i(((T=(V=R.response)==null?void 0:V.data)==null?void 0:T.error)||"上传失败","error")}finally{c[a]=!1}}},y=async a=>{var M,V;const w=p[a];if(w){if(!w.startsWith("https://")){i("仅支持 HTTPS 协议","error");return}U[a]=!0;try{const T=await D.post(`/admin/prompts/${a}/import-url`,{url:w,validate:!0});T.success?(f[a]=T.preview||T.content,i("预览加载成功","success")):i(T.error||"预览失败","error")}catch(T){console.error(`Failed to preview ${a} prompt:`,T),i(((V=(M=T.response)==null?void 0:M.data)==null?void 0:V.error)||"预览失败","error")}finally{U[a]=!1}}},N=async a=>{var M,V;const w=p[a];if(w){if(!w.startsWith("https://")){i("仅支持 HTTPS 协议","error");return}U[a]=!0;try{const T=await D.post(`/admin/prompts/${a}/import-url`,{url:w,validate:!1});T.success?(i("导入成功","success"),await P(),_[a]="manual",p[a]="",f[a]=null):i(T.error||"导入失败","error")}catch(T){console.error(`Failed to import ${a} prompt:`,T),i(((V=(M=T.response)==null?void 0:M.data)==null?void 0:V.error)||"导入失败","error")}finally{U[a]=!1}}},$=a=>a?new Date(a).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"";return xe(()=>{P()}),{services:A,editModes:m,loading:j,prompts:o,metadata:x,serviceConfigs:K,saving:l,uploading:c,importing:U,currentMode:_,importUrls:p,urlPreviews:f,savePrompt:q,triggerFileUpload:S,handleFileUpload:J,previewFromUrl:y,importFromUrl:N,formatDateTime:$}}},Le={class:"prompts-container"},Oe={key:0,class:"mb-4 sm:mb-6"},Re={key:1,class:"py-12 text-center"},Ne={key:2,class:"space-y-6"},Qe={class:"mb-4 flex items-center justify-between"},We={class:"flex items-center"},Ke={class:"mr-3 flex h-10 w-10 items-center justify-center rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 text-white"},qe={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},ze={class:"text-sm text-gray-500 dark:text-gray-400"},He={class:"text-right"},Je={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Xe={key:0,class:"inline-flex items-center rounded-full bg-blue-100 px-2.5 py-0.5 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-200"},Ye={key:0,class:"mb-4 rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20"},Ge={class:"flex items-start"},Ze={class:"flex-1"},et={class:"mt-1 text-xs text-blue-700 dark:text-blue-300"},tt={class:"rounded bg-blue-100 px-1.5 py-0.5 dark:bg-blue-800"},at={class:"ml-2"},rt={class:"mt-2 flex items-center text-xs"},st={class:"mb-4"},lt={class:"flex space-x-4"},ot=["onClick"],nt=["onUpdate:modelValue","placeholder","rows"],dt={class:"mt-3 flex items-center justify-between"},it={class:"text-xs text-gray-500 dark:text-gray-400"},ut={key:0},gt=["disabled","onClick"],ct={key:0,class:"loading-spinner mr-2"},ft={key:1,class:"fas fa-save mr-2"},pt={class:"rounded-lg bg-gray-50 p-6 dark:bg-gray-700"},mt=["onChange"],bt=["disabled"],xt={key:0,class:"loading-spinner mr-2"},yt={key:1,class:"fas fa-upload mr-2"},vt={class:"space-y-3"},kt=["for"],ht=["id","onUpdate:modelValue"],wt={class:"flex items-center space-x-3"},Ct=["disabled","onClick"],Ut=["disabled","onClick"],Tt={key:0,class:"loading-spinner mr-2"},St={key:1,class:"fas fa-download mr-2"},Bt={key:0,class:"mt-4 rounded-lg bg-gray-50 p-4 dark:bg-gray-700"},Mt={class:"mb-2 flex items-center justify-between"},Dt=["onClick"],At={class:"max-h-64 overflow-auto rounded border border-gray-200 bg-white p-3 text-xs dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300"};function It(A,m,j,o,x,K){return d(),n("div",Le,[e("div",{class:E(j.embedded?"":"card p-4 sm:p-6")},[j.embedded?v("",!0):(d(),n("div",Oe,m[1]||(m[1]=[e("h3",{class:"mb-1 text-lg font-bold text-gray-900 dark:text-gray-100 sm:mb-2 sm:text-xl"}," System Prompts 管理 ",-1),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 sm:text-base"}," 管理各服务的默认系统提示词 ",-1)]))),o.loading?(d(),n("div",Re,m[2]||(m[2]=[e("div",{class:"loading-spinner mx-auto mb-4"},null,-1),e("p",{class:"text-gray-500 dark:text-gray-400"},"正在加载 Prompts...",-1)]))):(d(),n("div",Ne,[(d(!0),n(X,null,te(o.services,l=>{var c,U,_,p;return d(),n("div",{key:l.id,class:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm dark:border-gray-700 dark:bg-gray-800 sm:p-6"},[e("div",Qe,[e("div",We,[e("div",Ke,[e("i",{class:E(["text-lg",l.icon])},null,2)]),e("div",null,[e("h3",qe,b(l.name),1),e("p",ze,b(l.description),1)])]),e("div",He,[e("div",Je,[o.prompts[l.id]?(d(),n("span",Xe,b(o.prompts[l.id].length)+" 字符 ",1)):v("",!0)])])]),o.serviceConfigs[l.id]?(d(),n("div",Ye,[e("div",Ge,[m[5]||(m[5]=e("i",{class:"fas fa-info-circle mr-2 mt-0.5 text-blue-600 dark:text-blue-400"},null,-1)),e("div",Ze,[m[4]||(m[4]=e("div",{class:"text-sm font-medium text-blue-900 dark:text-blue-200"},"环境变量配置",-1)),e("div",et,[e("code",tt,b(o.serviceConfigs[l.id].envVar||"N/A"),1),e("span",at,b(o.serviceConfigs[l.id].envDescription||""),1)]),e("div",rt,[m[3]||(m[3]=e("span",{class:"font-medium text-blue-900 dark:text-blue-200"},"当前状态:",-1)),e("span",{class:E(["ml-2 inline-flex items-center rounded-full px-2 py-0.5 font-medium",(c=o.metadata[l.id])!=null&&c.enabled?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"])},[e("i",{class:E(["mr-1 text-xs",(U=o.metadata[l.id])!=null&&U.enabled?"fas fa-check-circle":"fas fa-times-circle"])},null,2),u(" "+b((_=o.metadata[l.id])!=null&&_.enabled?"已启用":"已禁用"),1)],2)])])])])):v("",!0),e("div",st,[e("nav",lt,[(d(!0),n(X,null,te(o.editModes,f=>(d(),n("button",{key:f.id,class:E(["rounded-lg px-3 py-2 text-sm font-medium transition-colors",o.currentMode[l.id]===f.id?"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-200":"text-gray-600 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-gray-200"]),onClick:L=>o.currentMode[l.id]=f.id},[e("i",{class:E(["mr-2",f.icon])},null,2),u(" "+b(f.name),1)],10,ot))),128))])]),g(e("div",null,[g(e("textarea",{"onUpdate:modelValue":f=>o.prompts[l.id]=f,class:"form-input w-full font-mono text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",placeholder:`输入 ${l.name} 的 system prompt...`,rows:l.id==="codex"?25:3},null,8,nt),[[h,o.prompts[l.id]]]),e("div",dt,[e("div",it,[(p=o.metadata[l.id])!=null&&p.lastModified?(d(),n("span",ut,[m[6]||(m[6]=e("i",{class:"fas fa-clock mr-1"},null,-1)),u(" 最后修改: "+b(o.formatDateTime(o.metadata[l.id].lastModified)),1)])):v("",!0)]),e("button",{class:E(["btn btn-primary px-4 py-2",{"cursor-not-allowed opacity-50":o.saving[l.id]}]),disabled:o.saving[l.id],onClick:f=>o.savePrompt(l.id)},[o.saving[l.id]?(d(),n("div",ct)):(d(),n("i",ft)),u(" "+b(o.saving[l.id]?"保存中...":"保存"),1)],10,gt)])],512),[[H,o.currentMode[l.id]==="manual"]]),g(e("div",null,[e("div",pt,[m[7]||(m[7]=e("div",{class:"mb-4 text-center"},[e("i",{class:"fas fa-upload mb-2 text-4xl text-gray-400 dark:text-gray-500"}),e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"支持 .txt 格式，最大 1MB")],-1)),e("input",{ref_for:!0,ref:`fileInput_${l.id}`,accept:".txt",class:"hidden",type:"file",onChange:f=>o.handleFileUpload(l.id,f)},null,40,mt),e("button",{class:"btn btn-success mx-auto block px-6 py-3",disabled:o.uploading[l.id],onClick:m[0]||(m[0]=f=>o.triggerFileUpload())},[o.uploading[l.id]?(d(),n("div",xt)):(d(),n("i",yt)),u(" "+b(o.uploading[l.id]?"上传中...":"选择文件上传"),1)],8,bt)])],512),[[H,o.currentMode[l.id]==="upload"]]),g(e("div",null,[e("div",vt,[e("div",null,[e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",for:`url_${l.id}`}," HTTPS URL ",8,kt),g(e("input",{id:`url_${l.id}`,"onUpdate:modelValue":f=>o.importUrls[l.id]=f,class:"form-input w-full dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",placeholder:"https://example.com/prompt.txt",type:"url"},null,8,ht),[[h,o.importUrls[l.id]]]),m[8]||(m[8]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 仅支持 HTTPS 协议，最大 1MB ",-1))]),e("div",wt,[e("button",{class:"btn btn-primary px-4 py-2",disabled:!o.importUrls[l.id]||o.importing[l.id],onClick:f=>o.previewFromUrl(l.id)},m[9]||(m[9]=[e("i",{class:"fas fa-eye mr-2"},null,-1),u(" 预览 ",-1)]),8,Ct),e("button",{class:"btn btn-success px-4 py-2",disabled:!o.importUrls[l.id]||o.importing[l.id],onClick:f=>o.importFromUrl(l.id)},[o.importing[l.id]?(d(),n("div",Tt)):(d(),n("i",St)),u(" "+b(o.importing[l.id]?"导入中...":"直接导入"),1)],8,Ut)]),o.urlPreviews[l.id]?(d(),n("div",Bt,[e("div",Mt,[m[11]||(m[11]=e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 预览内容 ",-1)),e("button",{class:"text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",onClick:f=>o.urlPreviews[l.id]=null},m[10]||(m[10]=[e("i",{class:"fas fa-times"},null,-1)]),8,Dt)]),e("pre",At,b(o.urlPreviews[l.id]),1)])):v("",!0)])],512),[[H,o.currentMode[l.id]==="url"]])])}),128))]))],2)])}const Et=ye(je,[["render",It],["__scopeId","data-v-c1765934"]]),Vt={class:"settings-container"},Pt={class:"card p-4 sm:p-6"},_t={class:"mb-6"},$t={class:"flex space-x-8"},Ft={key:0,class:"py-12 text-center"},jt={key:1},Lt={class:"table-container hidden sm:block"},Ot={class:"min-w-full"},Rt={class:"divide-y divide-gray-200/50 dark:divide-gray-600/50"},Nt={class:"table-row"},Qt={class:"px-6 py-4"},Wt={class:"table-row"},Kt={class:"px-6 py-4"},qt={class:"space-y-3"},zt={key:0,class:"inline-flex items-center gap-3 rounded-lg bg-gray-50 p-3 dark:bg-gray-700"},Ht=["src"],Jt={class:"table-row"},Xt={class:"px-6 py-4"},Yt={class:"flex items-center"},Gt={class:"inline-flex cursor-pointer items-center"},Zt={class:"ml-3 text-sm font-medium text-gray-900 dark:text-gray-300"},ea={class:"px-6 py-6",colspan:"2"},ta={class:"flex items-center justify-between"},aa={class:"flex gap-3"},ra=["disabled"],sa={key:0,class:"loading-spinner mr-2"},la={key:1,class:"fas fa-save mr-2"},oa=["disabled"],na={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},da={class:"space-y-4 sm:hidden"},ia={class:"glass-card p-4"},ua={class:"glass-card p-4"},ga={class:"space-y-3"},ca={key:0,class:"inline-flex items-center gap-3 rounded-lg bg-gray-50 p-3 dark:bg-gray-700"},fa=["src"],pa={class:"glass-card p-4"},ma={class:"space-y-2"},ba={class:"inline-flex cursor-pointer items-center"},xa={class:"ml-3 text-sm font-medium text-gray-900 dark:text-gray-300"},ya={class:"glass-card p-4"},va={class:"flex flex-col gap-3"},ka=["disabled"],ha={key:0,class:"loading-spinner mr-2"},wa={key:1,class:"fas fa-save mr-2"},Ca=["disabled"],Ua={key:0,class:"text-center text-sm text-gray-500 dark:text-gray-400"},Ta={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},Sa={class:"flex items-center justify-between"},Ba={class:"relative inline-flex cursor-pointer items-center"},Ma={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},Da={class:"space-y-3"},Aa={class:"font-medium text-gray-700 dark:text-gray-300"},Ia={class:"ml-2 text-sm text-gray-500 dark:text-gray-400"},Ea={class:"relative inline-flex cursor-pointer items-center"},Va=["onUpdate:modelValue"],Pa={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},_a={class:"mb-4 flex items-center justify-between"},$a={key:0,class:"space-y-4"},Fa={class:"flex items-start justify-between"},ja={class:"flex-1"},La={class:"flex items-center"},Oa={class:"font-semibold text-gray-800 dark:text-gray-200"},Ra={class:"text-sm text-gray-500 dark:text-gray-400"},Na={class:"mt-3 space-y-1 text-sm"},Qa={key:0,class:"flex items-center text-gray-600 dark:text-gray-400"},Wa={class:"truncate"},Ka={key:1,class:"flex items-center text-gray-600 dark:text-gray-400"},qa={class:"truncate"},za={key:2,class:"flex items-center text-gray-600 dark:text-gray-400"},Ha={class:"truncate"},Ja={key:3,class:"flex items-center text-gray-600 dark:text-gray-400"},Xa={class:"truncate"},Ya={key:4,class:"flex items-center text-gray-600 dark:text-gray-400"},Ga={class:"truncate"},Za={key:5,class:"flex items-center text-gray-600 dark:text-gray-400"},er={class:"truncate"},tr={key:6,class:"flex items-center text-gray-600 dark:text-gray-400"},ar={class:"ml-4 flex items-center space-x-2"},rr={class:"relative inline-flex cursor-pointer items-center"},sr=["checked","onChange"],lr=["onClick"],or=["onClick"],nr=["onClick"],dr={key:1,class:"py-8 text-center text-gray-500 dark:text-gray-400"},ir={class:"rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},ur={class:"grid grid-cols-1 gap-4 md:grid-cols-3"},gr={key:0,class:"py-12 text-center"},cr={key:1},fr={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},pr={class:"flex items-center justify-between"},mr={class:"relative inline-flex cursor-pointer items-center"},br={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},xr={class:"flex items-center justify-between"},yr={class:"relative inline-flex cursor-pointer items-center"},vr={key:0,class:"mt-6 space-y-4"},kr={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},hr={class:"flex items-center justify-between"},wr={class:"relative inline-flex cursor-pointer items-center"},Cr={key:0,class:"mt-6 space-y-4"},Ur={key:0,class:"rounded-lg bg-gray-50 p-4 text-sm text-gray-500 dark:bg-gray-700/50 dark:text-gray-400"},Tr={key:0,class:"ml-2"},Sr={class:"dark:to-gray-750 relative border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-5 dark:border-gray-700 dark:from-gray-800"},Br={class:"flex items-center justify-between"},Mr={class:"flex items-center space-x-3"},Dr={class:"text-xl font-semibold text-gray-900 dark:text-white"},Ar={class:"mt-0.5 text-sm text-gray-600 dark:text-gray-400"},Ir={class:"p-6"},Er={class:"space-y-5"},Vr={class:"relative"},Pr=["disabled"],_r={key:0,class:"mt-1 text-xs text-amber-600 dark:text-amber-400"},$r={key:0},Fr={class:"relative"},jr={key:0,class:"absolute inset-y-0 right-0 flex items-center pr-3"},Lr={key:1,class:"absolute inset-y-0 right-0 flex items-center pr-3"},Or={key:0,class:"mt-2 flex items-start rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20"},Rr={class:"text-sm text-blue-700 dark:text-blue-300"},Nr={key:1,class:"space-y-5"},Qr={key:2,class:"space-y-5"},Wr={key:3,class:"space-y-5"},Kr={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},qr={key:4,class:"rounded-xl border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-900/50"},zr={class:"space-y-4"},Hr={class:"flex items-center justify-between"},Jr={class:"flex cursor-pointer items-center",for:"enableSign"},Xr={key:0,class:"rounded-full bg-green-100 px-2 py-1 text-xs font-medium text-green-700 dark:bg-green-900/50 dark:text-green-400"},Yr={key:0},Gr={class:"border-t border-gray-200 bg-gray-50 px-6 py-4 dark:border-gray-700 dark:bg-gray-900/50"},Zr={class:"flex items-center justify-between"},es={class:"flex space-x-3"},ts=["disabled"],as=["disabled"],rs=Object.assign({name:"SettingsView"},{__name:"SettingsView",setup(A){const m=Fe(),{loading:j,saving:o,oemSettings:x}=Ee(m),K=B(),l=B("branding"),c=B(!0),U=B(new AbortController),_=pe({get(){return!x.value.showAdminButton},set(r){x.value.showAdminButton=!r}}),p=B(!1),f=B(!1),L=B(!1),P=B(!1),q={accountAnomaly:!0,quotaWarning:!0,systemError:!0,securityAlert:!0,rateLimitRecovery:!0},S=B({enabled:!1,platforms:[],notificationTypes:{...q},retrySettings:{maxRetries:3,retryDelay:1e3,timeout:1e4}}),J=B(!1),y=B({claudeCodeOnlyEnabled:!1,globalSessionBindingEnabled:!1,sessionBindingErrorMessage:"你的本地session已污染，请清理后使用。",sessionBindingTtlDays:30,userMessageQueueEnabled:!0,userMessageQueueDelayMs:200,userMessageQueueTimeoutMs:3e4,updatedAt:null,updatedBy:null}),N=B(!1),$=B(null),a=B({type:"wechat_work",name:"",url:"",enableSign:!1,secret:"",botToken:"",chatId:"",apiBaseUrl:"",proxyUrl:"",deviceKey:"",serverUrl:"",level:"",sound:"",group:"",host:"",port:null,secure:!1,user:"",pass:"",from:"",to:"",timeout:null,ignoreTLS:!1}),w=me(l,async r=>{c.value&&(r==="webhook"?await T():r==="claude"&&await Y())}),M=me(()=>a.value.type,r=>{p.value=!1,f.value=!1,$.value||(r==="bark"?(a.value.url="",a.value.enableSign=!1,a.value.secret="",a.value.botToken="",a.value.chatId="",a.value.apiBaseUrl="",a.value.proxyUrl="",a.value.host="",a.value.port=null,a.value.secure=!1,a.value.user="",a.value.pass="",a.value.from="",a.value.to="",a.value.timeout=null,a.value.ignoreTLS=!1):r==="smtp"?(a.value.url="",a.value.enableSign=!1,a.value.secret="",a.value.deviceKey="",a.value.serverUrl="",a.value.level="",a.value.sound="",a.value.group="",a.value.botToken="",a.value.chatId="",a.value.apiBaseUrl="",a.value.proxyUrl=""):r==="telegram"?(a.value.url="",a.value.enableSign=!1,a.value.secret="",a.value.deviceKey="",a.value.serverUrl="",a.value.level="",a.value.sound="",a.value.group="",a.value.host="",a.value.port=null,a.value.secure=!1,a.value.user="",a.value.pass="",a.value.from="",a.value.to="",a.value.timeout=null,a.value.ignoreTLS=!1,a.value.botToken="",a.value.chatId="",a.value.apiBaseUrl="",a.value.proxyUrl=""):(a.value.deviceKey="",a.value.serverUrl="",a.value.level="",a.value.sound="",a.value.group="",a.value.host="",a.value.port=null,a.value.secure=!1,a.value.user="",a.value.pass="",a.value.from="",a.value.to="",a.value.timeout=null,a.value.ignoreTLS=!1,a.value.botToken="",a.value.chatId="",a.value.apiBaseUrl="",a.value.proxyUrl=""))}),V=pe(()=>a.value.type==="bark"?!!a.value.deviceKey:a.value.type==="telegram"?!!(a.value.botToken&&a.value.chatId):a.value.type==="smtp"?!!(a.value.host&&a.value.user&&a.value.pass&&a.value.to):!!a.value.url&&!p.value);xe(async()=>{try{await m.loadOemSettings(),l.value==="webhook"&&await T()}catch{i("加载设置失败","error")}}),Ve(()=>{c.value=!1,U.value&&U.value.abort(),w&&w(),M&&M(),N.value&&(N.value=!1,$.value=null)});const T=async()=>{if(c.value)try{const r=await D.get("/admin/webhook/config",{signal:U.value.signal});if(r.success&&c.value){const t=r.config||{};S.value={...t,notificationTypes:{...q,...t.notificationTypes||{}}}}}catch(r){if(r.name==="AbortError"||!c.value)return;i("获取webhook配置失败","error"),console.error(r)}},R=async()=>{if(c.value)try{const r={...S.value,notificationTypes:{...q,...S.value.notificationTypes||{}}};(await D.post("/admin/webhook/config",r,{signal:U.value.signal})).success&&c.value&&(S.value=r,i("配置已保存","success"))}catch(r){if(r.name==="AbortError"||!c.value)return;i("保存配置失败","error"),console.error(r)}},Y=async()=>{var r,t,s,C,I,Z,ge,ce,fe;if(c.value){J.value=!0;try{const F=await D.get("/admin/claude-relay-config",{signal:U.value.signal});F.success&&c.value&&(y.value={claudeCodeOnlyEnabled:((r=F.config)==null?void 0:r.claudeCodeOnlyEnabled)??!1,globalSessionBindingEnabled:((t=F.config)==null?void 0:t.globalSessionBindingEnabled)??!1,sessionBindingErrorMessage:((s=F.config)==null?void 0:s.sessionBindingErrorMessage)||"你的本地session已污染，请清理后使用。",sessionBindingTtlDays:((C=F.config)==null?void 0:C.sessionBindingTtlDays)??30,userMessageQueueEnabled:((I=F.config)==null?void 0:I.userMessageQueueEnabled)??!0,userMessageQueueDelayMs:((Z=F.config)==null?void 0:Z.userMessageQueueDelayMs)??200,userMessageQueueTimeoutMs:((ge=F.config)==null?void 0:ge.userMessageQueueTimeoutMs)??3e4,updatedAt:((ce=F.config)==null?void 0:ce.updatedAt)||null,updatedBy:((fe=F.config)==null?void 0:fe.updatedBy)||null})}catch(F){if(F.name==="AbortError"||!c.value)return;i("获取 Claude 转发配置失败","error"),console.error(F)}finally{c.value&&(J.value=!1)}}},z=async()=>{var r,t;if(c.value)try{const s={claudeCodeOnlyEnabled:y.value.claudeCodeOnlyEnabled,globalSessionBindingEnabled:y.value.globalSessionBindingEnabled,sessionBindingErrorMessage:y.value.sessionBindingErrorMessage,sessionBindingTtlDays:y.value.sessionBindingTtlDays,userMessageQueueEnabled:y.value.userMessageQueueEnabled,userMessageQueueDelayMs:y.value.userMessageQueueDelayMs,userMessageQueueTimeoutMs:y.value.userMessageQueueTimeoutMs},C=await D.put("/admin/claude-relay-config",s,{signal:U.value.signal});C.success&&c.value&&(y.value={...y.value,updatedAt:((r=C.config)==null?void 0:r.updatedAt)||new Date().toISOString(),updatedBy:((t=C.config)==null?void 0:t.updatedBy)||null},i("Claude 转发配置已保存","success"))}catch(s){if(s.name==="AbortError"||!c.value)return;i("保存 Claude 转发配置失败","error"),console.error(s)}},ve=()=>{if(["bark","smtp","telegram"].includes(a.value.type)){p.value=!1,f.value=!1;return}const r=a.value.url;if(!r){p.value=!1,f.value=!1;return}try{new URL(r),r.startsWith("http://")||r.startsWith("https://")?(p.value=!1,f.value=!0):(p.value=!0,f.value=!1)}catch{p.value=!0,f.value=!1}},re=()=>{if(a.value.type==="bark"){if(!a.value.deviceKey)return i("请输入Bark设备密钥","error"),!1}else if(a.value.type==="telegram"){if(!a.value.botToken)return i("请输入 Telegram 机器人 Token","error"),!1;if(!a.value.chatId)return i("请输入 Telegram Chat ID","error"),!1;if(a.value.apiBaseUrl)try{const r=new URL(a.value.apiBaseUrl);if(!["http:","https:"].includes(r.protocol))return i("Telegram API 基础地址仅支持 http 或 https","error"),!1}catch{return i("请输入有效的 Telegram API 基础地址","error"),!1}if(a.value.proxyUrl)try{const r=new URL(a.value.proxyUrl);if(!["http:","https:","socks4:","socks4a:","socks5:"].includes(r.protocol))return i("Telegram 代理仅支持 http/https/socks 协议","error"),!1}catch{return i("请输入有效的 Telegram 代理地址","error"),!1}}else if(a.value.type==="smtp"){const r=[{field:"host",message:"SMTP服务器"},{field:"user",message:"用户名"},{field:"pass",message:"密码"},{field:"to",message:"收件人邮箱"}];for(const{field:t,message:s}of r)if(!a.value[t])return i(`请输入${s}`,"error"),!1}else{if(!a.value.url)return i("请输入Webhook URL","error"),!1;if(p.value)return i("请输入有效的Webhook URL","error"),!1}return!0},ke=async()=>{if(c.value&&re()){P.value=!0;try{let r;$.value?r=await D.put(`/admin/webhook/platforms/${$.value.id}`,a.value,{signal:U.value.signal}):r=await D.post("/admin/webhook/platforms",a.value,{signal:U.value.signal}),r.success&&c.value&&(i($.value?"平台已更新":"平台已添加","success"),await T(),G())}catch(r){if(r.name==="AbortError"||!c.value)return;i(r.message||"操作失败","error"),console.error(r)}finally{c.value&&(P.value=!1)}}},he=r=>{$.value=r,a.value={type:r.type||"wechat_work",name:r.name||"",url:r.url||"",enableSign:r.enableSign||!1,secret:r.secret||"",botToken:r.botToken||"",chatId:r.chatId||"",apiBaseUrl:r.apiBaseUrl||"",proxyUrl:r.proxyUrl||"",deviceKey:r.deviceKey||"",serverUrl:r.serverUrl||"",level:r.level||"",sound:r.sound||"",group:r.group||"",host:r.host||"",port:r.port??null,secure:r.secure||!1,user:r.user||"",pass:r.pass||"",from:r.from||"",to:Array.isArray(r.to)?r.to.join(", "):r.to||"",timeout:r.timeout??null,ignoreTLS:r.ignoreTLS||!1},N.value=!0},we=async r=>{if(c.value&&confirm("确定要删除这个平台吗？"))try{(await D.delete(`/admin/webhook/platforms/${r}`,{signal:U.value.signal})).success&&c.value&&(i("平台已删除","success"),await T())}catch(t){if(t.name==="AbortError"||!c.value)return;i("删除失败","error"),console.error(t)}},Ce=async r=>{if(c.value)try{const t=await D.post(`/admin/webhook/platforms/${r}/toggle`,{},{signal:U.value.signal});t.success&&c.value&&(i(t.message,"success"),await T())}catch(t){if(t.name==="AbortError"||!c.value)return;i("操作失败","error"),console.error(t)}},Ue=async r=>{if(c.value)try{const t={type:r.type,secret:r.secret,enableSign:r.enableSign};r.type==="bark"?(t.deviceKey=r.deviceKey,t.serverUrl=r.serverUrl,t.level=r.level,t.sound=r.sound,t.group=r.group):r.type==="smtp"?(t.host=r.host,t.port=r.port,t.secure=r.secure,t.user=r.user,t.pass=r.pass,t.from=r.from,t.to=r.to,t.ignoreTLS=r.ignoreTLS):r.type==="telegram"?(t.botToken=r.botToken,t.chatId=r.chatId,t.apiBaseUrl=r.apiBaseUrl,t.proxyUrl=r.proxyUrl):t.url=r.url,(await D.post("/admin/webhook/test",t,{signal:U.value.signal})).success&&c.value&&i("测试成功","success")}catch(t){if(t.name==="AbortError"||!c.value)return;i(t.error||t.message||"测试失败","error"),console.error(t)}},Te=async()=>{if(c.value&&re()){L.value=!0;try{(await D.post("/admin/webhook/test",a.value,{signal:U.value.signal})).success&&c.value&&i("测试成功","success")}catch(r){if(r.name==="AbortError"||!c.value)return;i(r.error||r.message||"测试失败","error"),console.error(r)}finally{c.value&&(L.value=!1)}}},Se=async()=>{var r,t,s,C;if(c.value)try{(await D.post("/admin/webhook/test-notification",{},{signal:U.value.signal})).success&&c.value&&i("测试通知已发送","success")}catch(I){if(I.name==="AbortError"||!c.value)return;const Z=((t=(r=I==null?void 0:I.response)==null?void 0:r.data)==null?void 0:t.message)||((C=(s=I==null?void 0:I.response)==null?void 0:s.data)==null?void 0:C.error)||(I==null?void 0:I.message)||"发送失败";i(Z,"error"),console.error(I)}},G=()=>{c.value&&(N.value=!1,setTimeout(()=>{c.value&&($.value=null,a.value={type:"wechat_work",name:"",url:"",enableSign:!1,secret:"",botToken:"",chatId:"",apiBaseUrl:"",proxyUrl:"",deviceKey:"",serverUrl:"",level:"",sound:"",group:"",host:"",port:null,secure:!1,user:"",pass:"",from:"",to:"",timeout:null,ignoreTLS:!1},p.value=!1,f.value=!1,L.value=!1,P.value=!1)},0))},se=r=>({wechat_work:"企业微信",dingtalk:"钉钉",feishu:"飞书",slack:"Slack",discord:"Discord",telegram:"Telegram",bark:"Bark",smtp:"邮件通知",custom:"自定义"})[r]||r,Be=r=>({wechat_work:"fab fa-weixin text-green-600",dingtalk:"fas fa-comment-dots text-blue-500",feishu:"fas fa-dove text-blue-600",slack:"fab fa-slack text-purple-600",discord:"fab fa-discord text-indigo-600",telegram:"fab fa-telegram-plane text-sky-500",bark:"fas fa-bell text-orange-500",smtp:"fas fa-envelope text-blue-600",custom:"fas fa-webhook text-gray-600"})[r]||"fas fa-bell",le=r=>({wechat_work:"请在企业微信群机器人设置中获取Webhook地址",dingtalk:"请在钉钉群机器人设置中获取Webhook地址",feishu:"请在飞书群机器人设置中获取Webhook地址",slack:"请在Slack应用的Incoming Webhooks中获取地址",discord:"请在Discord服务器的集成设置中创建Webhook",telegram:"使用 @BotFather 创建机器人并复制 Token，Chat ID 可通过 @userinfobot 或相关工具获取",bark:"请在Bark App中查看您的设备密钥",smtp:"请配置SMTP服务器信息，支持Gmail、QQ邮箱等",custom:"请输入完整的Webhook接收地址"})[r]||"",Me=r=>r?r.length<=12?r:`${r.slice(0,6)}...${r.slice(-4)}`:"",De=r=>({accountAnomaly:"账号异常",quotaWarning:"配额警告",systemError:"系统错误",securityAlert:"安全警报",rateLimitRecovery:"限流恢复",test:"测试通知"})[r]||r,Ae=r=>({accountAnomaly:"账号状态异常、认证失败等",quotaWarning:"API调用配额不足警告",systemError:"系统运行错误和故障",securityAlert:"安全相关的警报通知",rateLimitRecovery:"限流状态恢复时发送提醒",test:"用于测试Webhook连接是否正常"})[r]||"",oe=async()=>{try{const r={siteName:x.value.siteName,siteIcon:x.value.siteIcon,siteIconData:x.value.siteIconData,showAdminButton:x.value.showAdminButton},t=await m.saveOemSettings(r);t&&t.success?i("OEM设置保存成功","success"):i((t==null?void 0:t.message)||"保存失败","error")}catch{i("保存OEM设置失败","error")}},ne=async()=>{if(confirm(`确定要重置为默认设置吗？

这将清除所有自定义的网站名称和图标设置。`))try{const r=await m.resetOemSettings();r&&r.success?i("已重置为默认设置","success"):i("重置失败","error")}catch{i("重置失败","error")}},de=async r=>{const t=r.target.files[0];if(!t)return;const s=m.validateIconFile(t);if(!s.isValid){s.errors.forEach(C=>i(C,"error"));return}try{const C=await m.fileToBase64(t);x.value.siteIconData=C}catch{i("文件读取失败","error")}r.target.value=""},ie=()=>{x.value.siteIcon="",x.value.siteIconData=""},ue=()=>{console.warn("Icon failed to load")},ae=m.formatDateTime;return(r,t)=>(d(),n(X,null,[e("div",Vt,[e("div",Pt,[t[114]||(t[114]=e("div",{class:"mb-4 sm:mb-6"},[e("h3",{class:"mb-1 text-lg font-bold text-gray-900 dark:text-gray-100 sm:mb-2 sm:text-xl"}," 系统设置 "),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 sm:text-base"},"网站定制和通知配置")],-1)),e("div",_t,[e("nav",$t,[e("button",{class:E(["border-b-2 pb-2 text-sm font-medium transition-colors",l.value==="branding"?"border-blue-500 text-blue-600 dark:border-blue-400 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"]),onClick:t[0]||(t[0]=s=>l.value="branding")},t[44]||(t[44]=[e("i",{class:"fas fa-palette mr-2"},null,-1),u(" 品牌设置 ",-1)]),2),e("button",{class:E(["border-b-2 pb-2 text-sm font-medium transition-colors",l.value==="webhook"?"border-blue-500 text-blue-600 dark:border-blue-400 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"]),onClick:t[1]||(t[1]=s=>l.value="webhook")},t[45]||(t[45]=[e("i",{class:"fas fa-bell mr-2"},null,-1),u(" 通知设置 ",-1)]),2),e("button",{class:E(["border-b-2 pb-2 text-sm font-medium transition-colors",l.value==="claude"?"border-blue-500 text-blue-600 dark:border-blue-400 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"]),onClick:t[2]||(t[2]=s=>l.value="claude")},t[46]||(t[46]=[e("i",{class:"fas fa-robot mr-2"},null,-1),u(" Claude 转发 ",-1)]),2),e("button",{class:E(["border-b-2 pb-2 text-sm font-medium transition-colors",l.value==="prompts"?"border-blue-500 text-blue-600 dark:border-blue-400 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"]),onClick:t[3]||(t[3]=s=>l.value="prompts")},t[47]||(t[47]=[e("i",{class:"fas fa-comment-dots mr-2"},null,-1),u(" Prompts 管理 ",-1)]),2)])]),k(j)?(d(),n("div",Ft,t[48]||(t[48]=[e("div",{class:"loading-spinner mx-auto mb-4"},null,-1),e("p",{class:"text-gray-500 dark:text-gray-400"},"正在加载设置...",-1)]))):(d(),n("div",jt,[g(e("div",null,[e("div",Lt,[e("table",Ot,[e("tbody",Rt,[e("tr",Nt,[t[50]||(t[50]=e("td",{class:"w-48 whitespace-nowrap px-6 py-4"},[e("div",{class:"flex items-center"},[e("div",{class:"mr-3 flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-blue-500 to-blue-600"},[e("i",{class:"fas fa-font text-xs text-white"})]),e("div",null,[e("div",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"}," 网站名称 "),e("div",{class:"text-xs text-gray-500 dark:text-gray-400"},"品牌标识")])])],-1)),e("td",Qt,[g(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>k(x).siteName=s),class:"form-input w-full max-w-md dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",maxlength:"100",placeholder:"Claude Relay Service",type:"text"},null,512),[[h,k(x).siteName]]),t[49]||(t[49]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 将显示在浏览器标题和页面头部 ",-1))])]),e("tr",Wt,[t[55]||(t[55]=e("td",{class:"w-48 whitespace-nowrap px-6 py-4"},[e("div",{class:"flex items-center"},[e("div",{class:"mr-3 flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-purple-500 to-purple-600"},[e("i",{class:"fas fa-image text-xs text-white"})]),e("div",null,[e("div",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"}," 网站图标 "),e("div",{class:"text-xs text-gray-500 dark:text-gray-400"},"Favicon")])])],-1)),e("td",Kt,[e("div",qt,[k(x).siteIconData||k(x).siteIcon?(d(),n("div",zt,[e("img",{alt:"图标预览",class:"h-8 w-8",src:k(x).siteIconData||k(x).siteIcon,onError:ue},null,40,Ht),t[52]||(t[52]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"当前图标",-1)),e("button",{class:"rounded-lg px-3 py-1 font-medium text-red-600 transition-colors hover:bg-red-50 hover:text-red-900",onClick:ie},t[51]||(t[51]=[e("i",{class:"fas fa-trash mr-1"},null,-1),u("删除 ",-1)]))])):v("",!0),e("div",null,[e("input",{ref_key:"iconFileInput",ref:K,accept:".ico,.png,.jpg,.jpeg,.svg",class:"hidden",type:"file",onChange:de},null,544),e("button",{class:"btn btn-success px-4 py-2",onClick:t[5]||(t[5]=s=>r.$refs.iconFileInput.click())},t[53]||(t[53]=[e("i",{class:"fas fa-upload mr-2"},null,-1),u(" 上传图标 ",-1)])),t[54]||(t[54]=e("span",{class:"ml-3 text-xs text-gray-500 dark:text-gray-400"},"支持 .ico, .png, .jpg, .svg 格式，最大 350KB",-1))])])])]),e("tr",Jt,[t[58]||(t[58]=e("td",{class:"w-48 whitespace-nowrap px-6 py-4"},[e("div",{class:"flex items-center"},[e("div",{class:"mr-3 flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-indigo-500 to-purple-600"},[e("i",{class:"fas fa-eye-slash text-xs text-white"})]),e("div",null,[e("div",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"}," 管理入口 "),e("div",{class:"text-xs text-gray-500 dark:text-gray-400"},"登录按钮显示")])])],-1)),e("td",Xt,[e("div",Yt,[e("label",Gt,[g(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>_.value=s),class:"peer sr-only",type:"checkbox"},null,512),[[W,_.value]]),t[56]||(t[56]=e("div",{class:"peer relative h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-blue-600 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:border-gray-600 dark:bg-gray-700 dark:peer-focus:ring-blue-800"},null,-1)),e("span",Zt,b(_.value?"隐藏登录按钮":"显示登录按钮"),1)])]),t[57]||(t[57]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 隐藏后，用户需要直接访问 /admin/login 页面登录 ",-1))])]),e("tr",null,[e("td",ea,[e("div",ta,[e("div",aa,[e("button",{class:E(["btn btn-primary px-6 py-3",{"cursor-not-allowed opacity-50":k(o)}]),disabled:k(o),onClick:oe},[k(o)?(d(),n("div",sa)):(d(),n("i",la)),u(" "+b(k(o)?"保存中...":"保存设置"),1)],10,ra),e("button",{class:"btn bg-gray-100 px-6 py-3 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",disabled:k(o),onClick:ne},t[59]||(t[59]=[e("i",{class:"fas fa-undo mr-2"},null,-1),u(" 重置为默认 ",-1)]),8,oa)]),k(x).updatedAt?(d(),n("div",na,[t[60]||(t[60]=e("i",{class:"fas fa-clock mr-1"},null,-1)),u(" 最后更新："+b(k(ae)(k(x).updatedAt)),1)])):v("",!0)])])])])])]),e("div",da,[e("div",ia,[t[61]||(t[61]=O('<div class="mb-3 flex items-center gap-3" data-v-12d2231a><div class="flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-cyan-600 text-white shadow-md" data-v-12d2231a><i class="fas fa-tag" data-v-12d2231a></i></div><div data-v-12d2231a><h3 class="text-base font-semibold text-gray-900 dark:text-gray-100" data-v-12d2231a>站点名称</h3><p class="text-sm text-gray-500 dark:text-gray-400" data-v-12d2231a>自定义您的站点品牌名称</p></div></div>',1)),g(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>k(x).siteName=s),class:"form-input w-full dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",maxlength:"100",placeholder:"Claude Relay Service",type:"text"},null,512),[[h,k(x).siteName]])]),e("div",ua,[t[65]||(t[65]=O('<div class="mb-3 flex items-center gap-3" data-v-12d2231a><div class="flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-xl bg-gradient-to-br from-purple-500 to-pink-600 text-white shadow-md" data-v-12d2231a><i class="fas fa-image" data-v-12d2231a></i></div><div data-v-12d2231a><h3 class="text-base font-semibold text-gray-900 dark:text-gray-100" data-v-12d2231a>站点图标</h3><p class="text-sm text-gray-500 dark:text-gray-400" data-v-12d2231a> 上传自定义图标或输入图标URL </p></div></div>',1)),e("div",ga,[k(x).siteIconData||k(x).siteIcon?(d(),n("div",ca,[e("img",{alt:"图标预览",class:"h-8 w-8",src:k(x).siteIconData||k(x).siteIcon,onError:ue},null,40,fa),t[62]||(t[62]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"当前图标",-1)),e("button",{class:"rounded-lg px-3 py-1 font-medium text-red-600 transition-colors hover:bg-red-50 hover:text-red-900",onClick:ie}," 删除 ")])):v("",!0),e("div",null,[e("input",{ref:"iconFileInputMobile",accept:".ico,.png,.jpg,.jpeg,.svg",class:"hidden",type:"file",onChange:de},null,544),e("button",{class:"btn btn-success px-4 py-2",onClick:t[8]||(t[8]=s=>r.$refs.iconFileInputMobile.click())},t[63]||(t[63]=[e("i",{class:"fas fa-upload mr-2"},null,-1),u(" 上传图标 ",-1)])),t[64]||(t[64]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"}," 支持 .ico, .png, .jpg, .svg 格式，最大 350KB ",-1))])])]),e("div",pa,[t[68]||(t[68]=O('<div class="mb-3 flex items-center gap-3" data-v-12d2231a><div class="flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 text-white shadow-md" data-v-12d2231a><i class="fas fa-eye-slash" data-v-12d2231a></i></div><div data-v-12d2231a><h3 class="text-base font-semibold text-gray-900 dark:text-gray-100" data-v-12d2231a>管理入口</h3><p class="text-sm text-gray-500 dark:text-gray-400" data-v-12d2231a>控制登录按钮在首页的显示</p></div></div>',1)),e("div",ma,[e("label",ba,[g(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>_.value=s),class:"peer sr-only",type:"checkbox"},null,512),[[W,_.value]]),t[66]||(t[66]=e("div",{class:"peer relative h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-blue-600 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:border-gray-600 dark:bg-gray-700 dark:peer-focus:ring-blue-800"},null,-1)),e("span",xa,b(_.value?"隐藏登录按钮":"显示登录按钮"),1)]),t[67]||(t[67]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," 隐藏后，用户需要直接访问 /admin/login 页面登录 ",-1))])]),e("div",ya,[e("div",va,[e("button",{class:E(["btn btn-primary w-full px-6 py-3",{"cursor-not-allowed opacity-50":k(o)}]),disabled:k(o),onClick:oe},[k(o)?(d(),n("div",ha)):(d(),n("i",wa)),u(" "+b(k(o)?"保存中...":"保存设置"),1)],10,ka),e("button",{class:"btn w-full bg-gray-100 px-6 py-3 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",disabled:k(o),onClick:ne},t[69]||(t[69]=[e("i",{class:"fas fa-undo mr-2"},null,-1),u(" 重置为默认 ",-1)]),8,Ca),k(x).updatedAt?(d(),n("div",Ua,[t[70]||(t[70]=e("i",{class:"fas fa-clock mr-1"},null,-1)),u(" 上次更新: "+b(k(ae)(k(x).updatedAt)),1)])):v("",!0)])])])],512),[[H,l.value==="branding"]]),g(e("div",null,[e("div",Ta,[e("div",Sa,[t[72]||(t[72]=e("div",null,[e("h2",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},"启用通知"),e("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," 开启后，系统将按配置发送通知到指定平台 ")],-1)),e("label",Ba,[g(e("input",{"onUpdate:modelValue":t[10]||(t[10]=s=>S.value.enabled=s),class:"peer sr-only",type:"checkbox",onChange:R},null,544),[[W,S.value.enabled]]),t[71]||(t[71]=e("div",{class:"peer h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-blue-600 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:border-gray-600 dark:bg-gray-700 dark:peer-focus:ring-blue-800"},null,-1))])])]),e("div",Ma,[t[74]||(t[74]=e("h2",{class:"mb-4 text-lg font-semibold text-gray-800 dark:text-gray-200"},"通知类型",-1)),e("div",Da,[(d(!0),n(X,null,te(S.value.notificationTypes,(s,C)=>(d(),n("div",{key:C,class:"flex items-center justify-between"},[e("div",null,[e("span",Aa,b(De(C)),1),e("span",Ia,b(Ae(C)),1)]),e("label",Ea,[g(e("input",{"onUpdate:modelValue":I=>S.value.notificationTypes[C]=I,class:"peer sr-only",type:"checkbox",onChange:R},null,40,Va),[[W,S.value.notificationTypes[C]]]),t[73]||(t[73]=e("div",{class:"peer h-5 w-9 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-4 after:w-4 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-green-600 peer-checked:after:translate-x-full peer-checked:after:border-white dark:border-gray-600 dark:bg-gray-700"},null,-1))])]))),128))])]),e("div",Pa,[e("div",_a,[t[76]||(t[76]=e("h2",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},"通知平台",-1)),e("button",{class:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-700",onClick:t[11]||(t[11]=s=>N.value=!0)},t[75]||(t[75]=[e("i",{class:"fas fa-plus mr-2"},null,-1),u(" 添加平台 ",-1)]))]),S.value.platforms&&S.value.platforms.length>0?(d(),n("div",$a,[(d(!0),n(X,null,te(S.value.platforms,s=>(d(),n("div",{key:s.id,class:"rounded-lg border border-gray-200 p-4 dark:border-gray-700"},[e("div",Fa,[e("div",ja,[e("div",La,[e("i",{class:E(["mr-3 text-xl",Be(s.type)])},null,2),e("div",null,[e("h3",Oa,b(s.name||se(s.type)),1),e("p",Ra,b(se(s.type)),1)])]),e("div",Na,[s.type!=="smtp"&&s.type!=="telegram"?(d(),n("div",Qa,[t[77]||(t[77]=e("i",{class:"fas fa-link mr-2"},null,-1)),e("span",Wa,b(s.url),1)])):v("",!0),s.type==="telegram"?(d(),n("div",Ka,[t[78]||(t[78]=e("i",{class:"fas fa-comments mr-2"},null,-1)),e("span",qa,"Chat ID: "+b(s.chatId||"未配置"),1)])):v("",!0),s.type==="telegram"&&s.botToken?(d(),n("div",za,[t[79]||(t[79]=e("i",{class:"fas fa-key mr-2"},null,-1)),e("span",Ha,"Token: "+b(Me(s.botToken)),1)])):v("",!0),s.type==="telegram"&&s.apiBaseUrl?(d(),n("div",Ja,[t[80]||(t[80]=e("i",{class:"fas fa-globe mr-2"},null,-1)),e("span",Xa,"API: "+b(s.apiBaseUrl),1)])):v("",!0),s.type==="telegram"&&s.proxyUrl?(d(),n("div",Ya,[t[81]||(t[81]=e("i",{class:"fas fa-route mr-2"},null,-1)),e("span",Ga,"代理: "+b(s.proxyUrl),1)])):v("",!0),s.type==="smtp"&&s.to?(d(),n("div",Za,[t[82]||(t[82]=e("i",{class:"fas fa-envelope mr-2"},null,-1)),e("span",er,b(Array.isArray(s.to)?s.to.join(", "):s.to),1)])):v("",!0),s.enableSign?(d(),n("div",tr,t[83]||(t[83]=[e("i",{class:"fas fa-shield-alt mr-2"},null,-1),e("span",null,"已启用签名验证",-1)]))):v("",!0)])]),e("div",ar,[e("label",rr,[e("input",{checked:s.enabled,class:"peer sr-only",type:"checkbox",onChange:C=>Ce(s.id)},null,40,sr),t[84]||(t[84]=e("div",{class:"peer h-5 w-9 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-4 after:w-4 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-green-600 peer-checked:after:translate-x-full peer-checked:after:border-white dark:border-gray-600 dark:bg-gray-700"},null,-1))]),e("button",{class:"rounded-lg bg-blue-100 p-2 text-blue-600 transition-colors hover:bg-blue-200 dark:bg-blue-900 dark:text-blue-400 dark:hover:bg-blue-800",title:"测试连接",onClick:C=>Ue(s)},t[85]||(t[85]=[e("i",{class:"fas fa-vial"},null,-1)]),8,lr),e("button",{class:"rounded-lg bg-gray-100 p-2 text-gray-600 transition-colors hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600",title:"编辑",onClick:C=>he(s)},t[86]||(t[86]=[e("i",{class:"fas fa-edit"},null,-1)]),8,or),e("button",{class:"rounded-lg bg-red-100 p-2 text-red-600 transition-colors hover:bg-red-200 dark:bg-red-900 dark:text-red-400 dark:hover:bg-red-800",title:"删除",onClick:C=>we(s.id)},t[87]||(t[87]=[e("i",{class:"fas fa-trash"},null,-1)]),8,nr)])])]))),128))])):(d(),n("div",dr,' 暂无配置的通知平台，请点击"添加平台"按钮添加 '))]),e("div",ir,[t[91]||(t[91]=e("h2",{class:"mb-4 text-lg font-semibold text-gray-800 dark:text-gray-200"},"高级设置",-1)),e("div",ur,[e("div",null,[t[88]||(t[88]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," 最大重试次数 ",-1)),g(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>S.value.retrySettings.maxRetries=s),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm",max:"10",min:"0",type:"number",onChange:R},null,544),[[h,S.value.retrySettings.maxRetries,void 0,{number:!0}]])]),e("div",null,[t[89]||(t[89]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," 重试延迟 (毫秒) ",-1)),g(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>S.value.retrySettings.retryDelay=s),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm",max:"10000",min:"100",step:"100",type:"number",onChange:R},null,544),[[h,S.value.retrySettings.retryDelay,void 0,{number:!0}]])]),e("div",null,[t[90]||(t[90]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," 超时时间 (毫秒) ",-1)),g(e("input",{"onUpdate:modelValue":t[14]||(t[14]=s=>S.value.retrySettings.timeout=s),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm",max:"30000",min:"1000",step:"1000",type:"number",onChange:R},null,544),[[h,S.value.retrySettings.timeout,void 0,{number:!0}]])])])]),e("div",{class:"mt-6 text-center"},[e("button",{class:"rounded-lg bg-green-600 px-6 py-3 text-white shadow-lg transition-all hover:bg-green-700 hover:shadow-xl",onClick:Se},t[92]||(t[92]=[e("i",{class:"fas fa-paper-plane mr-2"},null,-1),u(" 发送测试通知 ",-1)]))])],512),[[H,l.value==="webhook"]]),g(e("div",null,[J.value?(d(),n("div",gr,t[93]||(t[93]=[e("div",{class:"loading-spinner mx-auto mb-4"},null,-1),e("p",{class:"text-gray-500 dark:text-gray-400"},"正在加载配置...",-1)]))):(d(),n("div",cr,[e("div",fr,[e("div",pr,[t[95]||(t[95]=O('<div data-v-12d2231a><div class="flex items-center" data-v-12d2231a><div class="mr-3 flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-orange-500 to-amber-600 text-white shadow-lg" data-v-12d2231a><i class="fas fa-terminal" data-v-12d2231a></i></div><div data-v-12d2231a><h2 class="text-lg font-semibold text-gray-800 dark:text-gray-200" data-v-12d2231a> 仅允许 Claude Code 客户端 </h2><p class="mt-1 text-sm text-gray-600 dark:text-gray-400" data-v-12d2231a> 启用后，所有 <code class="rounded bg-gray-100 px-1 dark:bg-gray-700" data-v-12d2231a>/api/v1/messages</code> 和 <code class="rounded bg-gray-100 px-1 dark:bg-gray-700" data-v-12d2231a>/claude/v1/messages</code> 端点将强制验证 Claude Code CLI 客户端 </p></div></div></div>',1)),e("label",mr,[g(e("input",{"onUpdate:modelValue":t[15]||(t[15]=s=>y.value.claudeCodeOnlyEnabled=s),class:"peer sr-only",type:"checkbox",onChange:z},null,544),[[W,y.value.claudeCodeOnlyEnabled]]),t[94]||(t[94]=e("div",{class:"peer h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-orange-500 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-orange-300 dark:border-gray-600 dark:bg-gray-700 dark:peer-focus:ring-orange-800"},null,-1))])]),t[96]||(t[96]=O('<div class="mt-4 rounded-lg bg-amber-50 p-4 dark:bg-amber-900/20" data-v-12d2231a><div class="flex" data-v-12d2231a><i class="fas fa-info-circle mt-0.5 text-amber-500" data-v-12d2231a></i><div class="ml-3" data-v-12d2231a><p class="text-sm text-amber-700 dark:text-amber-300" data-v-12d2231a> 此设置与 API Key 级别的客户端限制是 <strong data-v-12d2231a>OR 逻辑</strong>：全局启用或 API Key 设置中启用，都会执行 Claude Code 验证。 </p></div></div></div>',1))]),e("div",br,[e("div",xr,[t[98]||(t[98]=O('<div data-v-12d2231a><div class="flex items-center" data-v-12d2231a><div class="mr-3 flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-purple-500 to-indigo-600 text-white shadow-lg" data-v-12d2231a><i class="fas fa-link" data-v-12d2231a></i></div><div data-v-12d2231a><h2 class="text-lg font-semibold text-gray-800 dark:text-gray-200" data-v-12d2231a> 强制会话绑定 </h2><p class="mt-1 text-sm text-gray-600 dark:text-gray-400" data-v-12d2231a> 启用后，系统会将原始会话 ID 绑定到首次使用的账户，确保上下文的一致性 </p></div></div></div>',1)),e("label",yr,[g(e("input",{"onUpdate:modelValue":t[16]||(t[16]=s=>y.value.globalSessionBindingEnabled=s),class:"peer sr-only",type:"checkbox",onChange:z},null,544),[[W,y.value.globalSessionBindingEnabled]]),t[97]||(t[97]=e("div",{class:"peer h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-purple-500 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 dark:border-gray-600 dark:bg-gray-700 dark:peer-focus:ring-purple-800"},null,-1))])]),y.value.globalSessionBindingEnabled?(d(),n("div",vr,[e("div",null,[t[99]||(t[99]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-clock mr-2 text-gray-400"}),u(" 绑定有效期（天） ")],-1)),g(e("input",{"onUpdate:modelValue":t[17]||(t[17]=s=>y.value.sessionBindingTtlDays=s),class:"mt-1 block w-full max-w-xs rounded-lg border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/20 dark:border-gray-500 dark:bg-gray-700 dark:text-white sm:text-sm",max:"365",min:"1",placeholder:"30",type:"number",onChange:z},null,544),[[h,y.value.sessionBindingTtlDays,void 0,{number:!0}]]),t[100]||(t[100]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 会话绑定到账户后的有效时间，过期后会自动解除绑定 ",-1))]),e("div",null,[t[101]||(t[101]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-exclamation-triangle mr-2 text-gray-400"}),u(" 旧会话污染提示 ")],-1)),g(e("textarea",{"onUpdate:modelValue":t[18]||(t[18]=s=>y.value.sessionBindingErrorMessage=s),class:"mt-1 block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/20 dark:border-gray-500 dark:bg-gray-700 dark:text-white sm:text-sm",placeholder:"你的本地session已污染，请清理后使用。",rows:"2",onChange:z},null,544),[[h,y.value.sessionBindingErrorMessage]]),t[102]||(t[102]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 当检测到为旧的sessionId且未在系统中有调度记录时提示，返回给客户端的错误消息 ",-1))])])):v("",!0),t[103]||(t[103]=O('<div class="mt-4 rounded-lg bg-purple-50 p-4 dark:bg-purple-900/20" data-v-12d2231a><div class="flex" data-v-12d2231a><i class="fas fa-lightbulb mt-0.5 text-purple-500" data-v-12d2231a></i><div class="ml-3" data-v-12d2231a><p class="text-sm text-purple-700 dark:text-purple-300" data-v-12d2231a><strong data-v-12d2231a>工作原理：</strong>系统会提取请求中的原始 session ID （来自 <code class="rounded bg-purple-100 px-1 dark:bg-purple-800" data-v-12d2231a>metadata.user_id</code>）， 并将其与首次调度的账户绑定。后续使用相同 session ID 的请求将自动路由到同一账户。 </p><p class="mt-2 text-sm text-purple-700 dark:text-purple-300" data-v-12d2231a><strong data-v-12d2231a>新会话识别：</strong>如果绑定会话历史中没有该sessionId但请求中 <code class="rounded bg-purple-100 px-1 dark:bg-purple-800" data-v-12d2231a>messages.length &gt; 1</code>， 系统会认为这是一个污染的会话并拒绝请求。 </p></div></div></div>',1))]),e("div",kr,[e("div",hr,[t[105]||(t[105]=O('<div data-v-12d2231a><div class="flex items-center" data-v-12d2231a><div class="mr-3 flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-cyan-500 to-teal-600 text-white shadow-lg" data-v-12d2231a><i class="fas fa-list-ol" data-v-12d2231a></i></div><div data-v-12d2231a><h2 class="text-lg font-semibold text-gray-800 dark:text-gray-200" data-v-12d2231a> 用户消息串行队列 </h2><p class="mt-1 text-sm text-gray-600 dark:text-gray-400" data-v-12d2231a> 启用后，同一账户的用户消息请求将串行执行，并在请求之间添加延迟，防止触发上游限流 </p></div></div></div>',1)),e("label",wr,[g(e("input",{"onUpdate:modelValue":t[19]||(t[19]=s=>y.value.userMessageQueueEnabled=s),class:"peer sr-only",type:"checkbox",onChange:z},null,544),[[W,y.value.userMessageQueueEnabled]]),t[104]||(t[104]=e("div",{class:"peer h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-teal-500 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-teal-300 dark:border-gray-600 dark:bg-gray-700 dark:peer-focus:ring-teal-800"},null,-1))])]),y.value.userMessageQueueEnabled?(d(),n("div",Cr,[e("div",null,[t[106]||(t[106]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-hourglass-half mr-2 text-gray-400"}),u(" 请求间隔（毫秒） ")],-1)),g(e("input",{"onUpdate:modelValue":t[20]||(t[20]=s=>y.value.userMessageQueueDelayMs=s),class:"mt-1 block w-full max-w-xs rounded-lg border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-teal-500 focus:outline-none focus:ring-2 focus:ring-teal-500/20 dark:border-gray-500 dark:bg-gray-700 dark:text-white sm:text-sm",max:"10000",min:"0",placeholder:"200",type:"number",onChange:z},null,544),[[h,y.value.userMessageQueueDelayMs,void 0,{number:!0}]]),t[107]||(t[107]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 同一账户的用户消息请求之间的最小间隔时间（0-10000毫秒） ",-1))]),e("div",null,[t[108]||(t[108]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-stopwatch mr-2 text-gray-400"}),u(" 队列超时（毫秒） ")],-1)),g(e("input",{"onUpdate:modelValue":t[21]||(t[21]=s=>y.value.userMessageQueueTimeoutMs=s),class:"mt-1 block w-full max-w-xs rounded-lg border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-teal-500 focus:outline-none focus:ring-2 focus:ring-teal-500/20 dark:border-gray-500 dark:bg-gray-700 dark:text-white sm:text-sm",max:"300000",min:"1000",placeholder:"30000",type:"number",onChange:z},null,544),[[h,y.value.userMessageQueueTimeoutMs,void 0,{number:!0}]]),t[109]||(t[109]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 请求在队列中等待的最大时间，超时将返回 503 错误（1000-300000毫秒） ",-1))])])):v("",!0),t[110]||(t[110]=O('<div class="mt-4 rounded-lg bg-teal-50 p-4 dark:bg-teal-900/20" data-v-12d2231a><div class="flex" data-v-12d2231a><i class="fas fa-info-circle mt-0.5 text-teal-500" data-v-12d2231a></i><div class="ml-3" data-v-12d2231a><p class="text-sm text-teal-700 dark:text-teal-300" data-v-12d2231a><strong data-v-12d2231a>工作原理：</strong>系统检测请求中最后一条消息的 <code class="rounded bg-teal-100 px-1 dark:bg-teal-800" data-v-12d2231a>role</code> 是否为 <code class="rounded bg-teal-100 px-1 dark:bg-teal-800" data-v-12d2231a>user</code>。用户消息请求需要排队串行执行，而工具调用结果、助手消息续传等不受此限制。 </p></div></div></div>',1))]),y.value.updatedAt?(d(),n("div",Ur,[t[113]||(t[113]=e("i",{class:"fas fa-history mr-2"},null,-1)),u(" 最后更新："+b(k(ae)(y.value.updatedAt))+" ",1),y.value.updatedBy?(d(),n("span",Tr,[t[111]||(t[111]=u(" 由 ",-1)),e("strong",null,b(y.value.updatedBy),1),t[112]||(t[112]=u(" 修改 ",-1))])):v("",!0)])):v("",!0)]))],512),[[H,l.value==="claude"]]),g(e("div",null,[be(Et,{embedded:!0})],512),[[H,l.value==="prompts"]])]))])]),N.value?(d(),n("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm transition-all duration-300 ease-out",onClick:G},[e("div",{class:"relative mx-4 w-full max-w-2xl overflow-hidden rounded-2xl bg-white shadow-2xl transition-all duration-300 ease-out dark:bg-gray-800",onClick:t[43]||(t[43]=$e(()=>{},["stop"]))},[e("div",Sr,[e("div",Br,[e("div",Mr,[t[115]||(t[115]=e("div",{class:"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 text-white shadow-lg"},[e("i",{class:"fas fa-bell"})],-1)),e("div",null,[e("h3",Dr,b($.value?"编辑":"添加")+"通知平台 ",1),e("p",Ar," 配置"+b($.value?"并更新":"新的")+"Webhook通知渠道 ",1)])]),e("button",{class:"rounded-lg p-2 text-gray-400 transition-colors hover:bg-gray-100 hover:text-gray-600 dark:hover:bg-gray-700 dark:hover:text-gray-300",onClick:G},t[116]||(t[116]=[e("i",{class:"fas fa-times text-lg"},null,-1)]))])]),e("div",Ir,[e("div",Er,[e("div",null,[t[120]||(t[120]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-layer-group mr-2 text-gray-400"}),u(" 平台类型 ")],-1)),e("div",Vr,[g(e("select",{"onUpdate:modelValue":t[22]||(t[22]=s=>a.value.type=s),class:"w-full appearance-none rounded-xl border border-gray-300 bg-white px-4 py-3 pr-10 text-gray-900 shadow-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white",disabled:$.value},t[117]||(t[117]=[O('<option value="wechat_work" data-v-12d2231a>🟢 企业微信</option><option value="dingtalk" data-v-12d2231a>🔵 钉钉</option><option value="feishu" data-v-12d2231a>🟦 飞书</option><option value="slack" data-v-12d2231a>🟣 Slack</option><option value="discord" data-v-12d2231a>🟪 Discord</option><option value="telegram" data-v-12d2231a>✈️ Telegram</option><option value="bark" data-v-12d2231a>🔔 Bark</option><option value="smtp" data-v-12d2231a>📧 邮件通知</option><option value="custom" data-v-12d2231a>⚙️ 自定义</option>',9)]),8,Pr),[[ee,a.value.type]]),t[118]||(t[118]=e("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},[e("i",{class:"fas fa-chevron-down text-gray-400"})],-1))]),$.value?(d(),n("p",_r,t[119]||(t[119]=[e("i",{class:"fas fa-info-circle mr-1"},null,-1),u(" 编辑模式下不能更改平台类型 ",-1)]))):v("",!0)]),e("div",null,[t[121]||(t[121]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-tag mr-2 text-gray-400"}),u(" 名称 "),e("span",{class:"ml-2 text-xs text-gray-500"},"(可选)")],-1)),g(e("input",{"onUpdate:modelValue":t[23]||(t[23]=s=>a.value.name=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"例如：运维群通知、开发测试群",type:"text"},null,512),[[h,a.value.name]])]),a.value.type!=="bark"&&a.value.type!=="smtp"&&a.value.type!=="telegram"?(d(),n("div",$r,[t[125]||(t[125]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-link mr-2 text-gray-400"}),u(" Webhook URL "),e("span",{class:"ml-1 text-xs text-red-500"},"*")],-1)),e("div",Fr,[g(e("input",{"onUpdate:modelValue":t[24]||(t[24]=s=>a.value.url=s),class:E(["w-full rounded-xl border border-gray-300 bg-white px-4 py-3 pr-10 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",{"border-red-500 focus:border-red-500 focus:ring-red-500/20":p.value,"border-green-500 focus:border-green-500 focus:ring-green-500/20":f.value}]),placeholder:"https://...",required:"",type:"url",onInput:ve},null,34),[[h,a.value.url]]),f.value?(d(),n("div",jr,t[122]||(t[122]=[e("i",{class:"fas fa-check-circle text-green-500"},null,-1)]))):v("",!0),p.value?(d(),n("div",Lr,t[123]||(t[123]=[e("i",{class:"fas fa-exclamation-circle text-red-500"},null,-1)]))):v("",!0)]),le(a.value.type)?(d(),n("div",Or,[t[124]||(t[124]=e("i",{class:"fas fa-info-circle mr-2 mt-0.5 text-blue-600 dark:text-blue-400"},null,-1)),e("p",Rr,b(le(a.value.type)),1)])):v("",!0)])):v("",!0),a.value.type==="telegram"?(d(),n("div",Nr,[e("div",null,[t[126]||(t[126]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-robot mr-2 text-gray-400"}),u(" Bot Token "),e("span",{class:"ml-1 text-xs text-red-500"},"*")],-1)),g(e("input",{"onUpdate:modelValue":t[25]||(t[25]=s=>a.value.botToken=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"例如：123456789:ABCDEFghijk-xyz",required:"",type:"text"},null,512),[[h,a.value.botToken]]),t[127]||(t[127]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 在 Telegram 的 @BotFather 中创建机器人后获得的 Token ",-1))]),e("div",null,[t[128]||(t[128]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-comments mr-2 text-gray-400"}),u(" Chat ID "),e("span",{class:"ml-1 text-xs text-red-500"},"*")],-1)),g(e("input",{"onUpdate:modelValue":t[26]||(t[26]=s=>a.value.chatId=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"例如：123456789 或 -1001234567890",required:"",type:"text"},null,512),[[h,a.value.chatId]]),t[129]||(t[129]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 可使用 @userinfobot、@RawDataBot 或 API 获取聊天/频道的 Chat ID ",-1))]),e("div",null,[t[130]||(t[130]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-globe mr-2 text-gray-400"}),u(" API 基础地址 "),e("span",{class:"ml-2 text-xs text-gray-500"},"(可选)")],-1)),g(e("input",{"onUpdate:modelValue":t[27]||(t[27]=s=>a.value.apiBaseUrl=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"默认: https://api.telegram.org",type:"url"},null,512),[[h,a.value.apiBaseUrl]]),t[131]||(t[131]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 使用自建 Bot API 时可覆盖默认域名，需以 http 或 https 开头 ",-1))]),e("div",null,[t[132]||(t[132]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-route mr-2 text-gray-400"}),u(" 代理地址 "),e("span",{class:"ml-2 text-xs text-gray-500"},"(可选)")],-1)),g(e("input",{"onUpdate:modelValue":t[28]||(t[28]=s=>a.value.proxyUrl=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"例如：socks5://user:pass@127.0.0.1:1080",type:"text"},null,512),[[h,a.value.proxyUrl]]),t[133]||(t[133]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 支持 http、https、socks4/4a/5 代理，留空则直接连接 Telegram 官方 API ",-1))]),t[134]||(t[134]=e("div",{class:"flex items-start rounded-lg bg-blue-50 p-3 text-sm text-blue-700 dark:bg-blue-900/20 dark:text-blue-300"},[e("i",{class:"fas fa-info-circle mr-2 mt-0.5"}),e("div",null,"机器人需先加入对应群组或频道并授予发送消息权限，通知会以纯文本方式发送。")],-1))])):v("",!0),a.value.type==="bark"?(d(),n("div",Qr,[e("div",null,[t[135]||(t[135]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-key mr-2 text-gray-400"}),u(" 设备密钥 (Device Key) "),e("span",{class:"ml-1 text-xs text-red-500"},"*")],-1)),g(e("input",{"onUpdate:modelValue":t[29]||(t[29]=s=>a.value.deviceKey=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"例如：aBcDeFgHiJkLmNoPqRsTuVwX",required:"",type:"text"},null,512),[[h,a.value.deviceKey]]),t[136]||(t[136]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 在Bark App中查看您的推送密钥 ",-1))]),e("div",null,[t[137]||(t[137]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-server mr-2 text-gray-400"}),u(" 服务器地址 "),e("span",{class:"ml-2 text-xs text-gray-500"},"(可选)")],-1)),g(e("input",{"onUpdate:modelValue":t[30]||(t[30]=s=>a.value.serverUrl=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"默认: https://api.day.app/push",type:"url"},null,512),[[h,a.value.serverUrl]])]),e("div",null,[t[139]||(t[139]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-flag mr-2 text-gray-400"}),u(" 通知级别 ")],-1)),g(e("select",{"onUpdate:modelValue":t[31]||(t[31]=s=>a.value.level=s),class:"w-full appearance-none rounded-xl border border-gray-300 bg-white px-4 py-3 pr-10 text-gray-900 shadow-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},t[138]||(t[138]=[O('<option value="" data-v-12d2231a>自动（根据通知类型）</option><option value="passive" data-v-12d2231a>被动</option><option value="active" data-v-12d2231a>默认</option><option value="timeSensitive" data-v-12d2231a>时效性</option><option value="critical" data-v-12d2231a>紧急</option>',5)]),512),[[ee,a.value.level]])]),e("div",null,[t[141]||(t[141]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-volume-up mr-2 text-gray-400"}),u(" 通知声音 ")],-1)),g(e("select",{"onUpdate:modelValue":t[32]||(t[32]=s=>a.value.sound=s),class:"w-full appearance-none rounded-xl border border-gray-300 bg-white px-4 py-3 pr-10 text-gray-900 shadow-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},t[140]||(t[140]=[O('<option value="" data-v-12d2231a>自动（根据通知类型）</option><option value="default" data-v-12d2231a>默认</option><option value="alarm" data-v-12d2231a>警报</option><option value="bell" data-v-12d2231a>铃声</option><option value="birdsong" data-v-12d2231a>鸟鸣</option><option value="electronic" data-v-12d2231a>电子音</option><option value="glass" data-v-12d2231a>玻璃</option><option value="horn" data-v-12d2231a>喇叭</option><option value="silence" data-v-12d2231a>静音</option>',9)]),512),[[ee,a.value.sound]])]),e("div",null,[t[142]||(t[142]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-folder mr-2 text-gray-400"}),u(" 通知分组 "),e("span",{class:"ml-2 text-xs text-gray-500"},"(可选)")],-1)),g(e("input",{"onUpdate:modelValue":t[33]||(t[33]=s=>a.value.group=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"默认: claude-relay",type:"text"},null,512),[[h,a.value.group]])]),t[143]||(t[143]=e("div",{class:"mt-2 flex items-start rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20"},[e("i",{class:"fas fa-info-circle mr-2 mt-0.5 text-blue-600 dark:text-blue-400"}),e("div",{class:"text-sm text-blue-700 dark:text-blue-300"},[e("p",null,"1. 在iPhone上安装Bark App"),e("p",null,"2. 打开App获取您的设备密钥"),e("p",null,"3. 将密钥粘贴到上方输入框")])],-1))])):v("",!0),a.value.type==="smtp"?(d(),n("div",Wr,[e("div",null,[t[144]||(t[144]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-server mr-2 text-gray-400"}),u(" SMTP 服务器 "),e("span",{class:"ml-1 text-xs text-red-500"},"*")],-1)),g(e("input",{"onUpdate:modelValue":t[34]||(t[34]=s=>a.value.host=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"例如: smtp.gmail.com",required:"",type:"text"},null,512),[[h,a.value.host]])]),e("div",Kr,[e("div",null,[t[145]||(t[145]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-plug mr-2 text-gray-400"}),u(" 端口 ")],-1)),g(e("input",{"onUpdate:modelValue":t[35]||(t[35]=s=>a.value.port=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white",max:"65535",min:"1",placeholder:"587",type:"number"},null,512),[[h,a.value.port,void 0,{number:!0}]]),t[146]||(t[146]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 默认: 587 (TLS) 或 465 (SSL) ",-1))]),e("div",null,[t[148]||(t[148]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-shield-alt mr-2 text-gray-400"}),u(" 加密方式 ")],-1)),g(e("select",{"onUpdate:modelValue":t[36]||(t[36]=s=>a.value.secure=s),class:"w-full appearance-none rounded-xl border border-gray-300 bg-white px-4 py-3 pr-10 text-gray-900 shadow-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},t[147]||(t[147]=[e("option",{value:!1},"STARTTLS (端口587)",-1),e("option",{value:!0},"SSL/TLS (端口465)",-1)]),512),[[ee,a.value.secure]])])]),e("div",null,[t[149]||(t[149]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-user mr-2 text-gray-400"}),u(" 用户名 "),e("span",{class:"ml-1 text-xs text-red-500"},"*")],-1)),g(e("input",{"onUpdate:modelValue":t[37]||(t[37]=s=>a.value.user=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"user@example.com",required:"",type:"email"},null,512),[[h,a.value.user]])]),e("div",null,[t[150]||(t[150]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-lock mr-2 text-gray-400"}),u(" 密码 / 应用密码 "),e("span",{class:"ml-1 text-xs text-red-500"},"*")],-1)),g(e("input",{"onUpdate:modelValue":t[38]||(t[38]=s=>a.value.pass=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"邮箱密码或应用专用密码",required:"",type:"password"},null,512),[[h,a.value.pass]]),t[151]||(t[151]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 建议使用应用专用密码，而非邮箱登录密码 ",-1))]),e("div",null,[t[152]||(t[152]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-paper-plane mr-2 text-gray-400"}),u(" 发件人邮箱 "),e("span",{class:"ml-2 text-xs text-gray-500"},"(可选)")],-1)),g(e("input",{"onUpdate:modelValue":t[39]||(t[39]=s=>a.value.from=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"默认使用用户名邮箱",type:"email"},null,512),[[h,a.value.from]])]),e("div",null,[t[153]||(t[153]=e("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-envelope mr-2 text-gray-400"}),u(" 收件人邮箱 "),e("span",{class:"ml-1 text-xs text-red-500"},"*")],-1)),g(e("input",{"onUpdate:modelValue":t[40]||(t[40]=s=>a.value.to=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"admin@example.com",required:"",type:"email"},null,512),[[h,a.value.to]]),t[154]||(t[154]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"接收通知的邮箱地址",-1))])])):v("",!0),a.value.type==="dingtalk"||a.value.type==="feishu"?(d(),n("div",qr,[e("div",zr,[e("div",Hr,[e("label",Jr,[g(e("input",{id:"enableSign","onUpdate:modelValue":t[41]||(t[41]=s=>a.value.enableSign=s),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-500 focus:ring-offset-0",type:"checkbox"},null,512),[[W,a.value.enableSign]]),t[155]||(t[155]=e("span",{class:"ml-3 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-shield-alt mr-2 text-gray-400"}),u(" 启用签名验证 ")],-1))]),a.value.enableSign?(d(),n("span",Xr," 已启用 ")):v("",!0)]),be(_e,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 -translate-y-2","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 -translate-y-2"},{default:Pe(()=>[a.value.enableSign?(d(),n("div",Yr,[t[156]||(t[156]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 签名密钥 ",-1)),g(e("input",{"onUpdate:modelValue":t[42]||(t[42]=s=>a.value.secret=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-800 dark:text-white dark:placeholder:text-gray-500",placeholder:"SEC...",type:"text"},null,512),[[h,a.value.secret]])])):v("",!0)]),_:1})])])):v("",!0)])]),e("div",Gr,[e("div",Zr,[t[158]||(t[158]=e("div",{class:"text-xs text-gray-500 dark:text-gray-400"},[e("i",{class:"fas fa-asterisk mr-1 text-red-500"}),u(" 必填项 ")],-1)),e("div",es,[e("button",{class:"group flex items-center rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 shadow-sm transition-all hover:bg-gray-50 hover:shadow-md dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",onClick:G},t[157]||(t[157]=[e("i",{class:"fas fa-times mr-2 transition-transform group-hover:scale-110"},null,-1),u(" 取消 ",-1)])),e("button",{class:"group flex items-center rounded-xl border border-blue-200 bg-blue-50 px-4 py-2.5 text-sm font-medium text-blue-700 shadow-sm transition-all hover:bg-blue-100 hover:shadow-md dark:border-blue-800 dark:bg-blue-900/50 dark:text-blue-300 dark:hover:bg-blue-900/70",disabled:L.value,onClick:Te},[e("i",{class:E(["mr-2 transition-transform",L.value?"fas fa-spinner fa-spin":"fas fa-vial group-hover:scale-110"])},null,2),u(" "+b(L.value?"测试中...":"测试连接"),1)],8,ts),e("button",{class:"group flex items-center rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-5 py-2.5 text-sm font-medium text-white shadow-md transition-all hover:from-blue-700 hover:to-indigo-700 hover:shadow-lg disabled:cursor-not-allowed disabled:from-gray-400 disabled:to-gray-500",disabled:!V.value||P.value,onClick:ke},[e("i",{class:E(["mr-2 transition-transform",P.value?"fas fa-spinner fa-spin":"fas fa-save group-hover:scale-110"])},null,2),u(" "+b(P.value?"保存中...":$.value?"保存修改":"添加平台"),1)],8,as)])])])])])):v("",!0)],64))}}),ds=ye(rs,[["__scopeId","data-v-12d2231a"]]);export{ds as default};
